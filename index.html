<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.5, user-scalable=yes">
    <title>Subtitle Studio</title>
    <!-- JSZip -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <!-- YouTube IFrame API -->
    <script src="https://www.youtube.com/iframe_api"></script>
    <style>
        * {
            box-sizing: border-box;
            font-family: system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 0;
        }
        body {
            background: #f5f7fb;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            padding: 1rem;
        }
        .container {
            max-width: 1400px;
            width: 100%;
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }
        /* Ãœst satÄ±r: sekmeler ve dil seÃ§ici yan yana */
        .header {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            align-items: center;
            gap: 1rem;
        }
        /* Tabs - header iÃ§inde */
        .tabs {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            background: white;
            padding: 0.5rem;
            border-radius: 3rem;
            box-shadow: 0 4px 10px rgba(0,0,0,0.03);
            flex: 1 1 auto;
        }
        .tab-btn {
            background: transparent;
            border: none;
            padding: 0.8rem 2rem;
            border-radius: 3rem;
            font-size: 1rem;
            font-weight: 600;
            color: #4b5565;
            cursor: pointer;
            transition: 0.2s;
            flex: 1 1 auto;
            min-width: 120px;
        }
        .tab-btn.active {
            background: #3b82f6;
            color: white;
            box-shadow: 0 4px 12px rgba(59,130,246,0.4);
        }
        .lang-selector {
            background: white;
            padding: 0.5rem 1rem;
            border-radius: 3rem;
            box-shadow: 0 4px 10px rgba(0,0,0,0.03);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .lang-selector select {
            padding: 0.5rem 2rem 0.5rem 1rem;
            border-radius: 2rem;
            border: 1px solid #dde3ed;
            background: #f8fafc;
            font-size: 1rem;
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%234b5565' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><polyline points='6 9 12 15 18 9'/></svg>");
            background-repeat: no-repeat;
            background-position: right 0.7rem center;
            background-size: 16px;
        }
        .tab-content {
            display: none;
            background: white;
            border-radius: 1.5rem;
            padding: 1.5rem;
            box-shadow: 0 8px 20px rgba(0,0,0,0.05);
        }
        .tab-content.active {
            display: block;
        }
        /* YAN YANA DÃœZEN */
        .split-panel {
            display: flex;
            flex-wrap: wrap;
            gap: 1.5rem;
        }
        .video-area {
            flex: 0 0 500px;
            min-width: 300px;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        .notes-area {
            flex: 1 1 450px;
            background: #f8fafc;
            border-radius: 1.2rem;
            padding: 1.2rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
            max-height: 650px;
            overflow-y: auto;
        }
        .player-container {
            background: #0f172a;
            border-radius: 1.2rem;
            overflow: hidden;
            aspect-ratio: 16/9;
            width: 100%;
            position: relative;
        }
        .live-container {
            background: #0f172a;
            border-radius: 1.2rem;
            overflow: hidden;
            aspect-ratio: 16/9;
            width: 100%;
            position: relative;
        }
        #cameraTab .live-container,
        #cameraTab .player-container {
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
        }
        #liveCamera {
            width: 100%;
            height: 100%;
            object-fit: cover;
            background: #0b0b1a;
        }
        #recordedVideo, #recordedVideoFile, #youtubeContainerYt {
            width: 100%;
            height: 100%;
            display: block;
            background: #0b0b1a;
        }
        #youtubeContainerYt iframe {
            width: 100%;
            height: 100%;
            border: none;
        }
        
        /* KAMERA SEÃ‡Ä°M DROPDOWN'U - Mobil iÃ§in optimize edildi */
        .camera-selector {
            position: absolute;
            bottom: 10px;
            right: 10px;
            z-index: 20;
        }

        .camera-selector-btn {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            background: rgba(0, 0, 0, 0.7);
            border: 2px solid white;
            color: white;
            font-size: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
            backdrop-filter: blur(5px);
        }

        .camera-selector-btn:hover {
            background: rgba(59, 130, 246, 0.8);
            transform: scale(1.05);
        }

        .camera-selector-btn.disabled {
            opacity: 0.4;
            pointer-events: none;
            cursor: not-allowed;
            background: rgba(100, 100, 100, 0.6);
        }

        .camera-selector-btn svg {
            width: 24px;
            height: 24px;
            fill: currentColor;
        }

        /* KAYDIRMA Ã‡UBUKLU DROPDOWN */
        .camera-dropdown {
            position: absolute;
            bottom: 50px;
            right: 0;
            background: white;
            border-radius: 16px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.25);
            width: 260px;
            max-height: 100px !important;
            overflow-y: auto;
            overflow-x: hidden;
            display: none;
            border: 1px solid rgba(255,255,255,0.2);
            background: rgba(255,255,255,0.98);
            -webkit-overflow-scrolling: touch;
        }

        .camera-dropdown::-webkit-scrollbar {
            width: 4px;
        }

        .camera-dropdown::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }

        .camera-dropdown::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }

        .camera-dropdown.show {
            display: block;
            animation: fadeIn 0.15s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(5px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .camera-option {
            padding: 8px 10px;
            cursor: pointer;
            transition: background 0.15s;
            color: #1e293b;
            font-size: 13px;
            display: flex;
            align-items: center;
            gap: 8px;
            border-bottom: 1px solid #f1f5f9;
        }

        .camera-option:last-child {
            border-bottom: none;
        }

        .camera-option:hover {
            background: #f8fafc;
        }

        .camera-option.selected {
            background: #3b82f6;
            color: white;
        }

        .camera-option.selected svg {
            fill: white;
        }

        .camera-option svg {
            width: 16px;
            height: 16px;
            fill: #64748b;
            flex-shrink: 0;
        }

        .camera-option .camera-name {
            flex: 1;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            font-size: 13px;
        }

        .camera-option .camera-badge {
            font-size: 9px;
            padding: 2px 6px;
            border-radius: 10px;
            background: #e2e8f0;
            color: #475569;
            white-space: nowrap;
            flex-shrink: 0;
        }

        .camera-option.selected .camera-badge {
            background: rgba(255,255,255,0.2);
            color: white;
        }

        .no-cameras-message {
            padding: 16px;
            text-align: center;
            color: #94a3b8;
            font-size: 13px;
        }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }
        .section-header h3 {
            margin: 0;
            font-size: 1.1rem;
        }
        button {
            background: #f1f4f9;
            border: none;
            padding: 0.6rem 1.2rem;
            border-radius: 3rem;
            font-size: 0.95rem;
            font-weight: 500;
            color: #1e293b;
            cursor: pointer;
            transition: all 0.2s;
            border: 1px solid #dde3ed;
        }
        button.primary {
            background: #3b82f6;
            color: white;
            border: none;
        }
        button.warning {
            background: #f59e0b;
            color: white;
            border: none;
        }
        button:active { transform: scale(0.96); }
        button:disabled { opacity: 0.5; pointer-events: none; }
        .duration-control {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: #eef2f6;
            padding: 0.3rem 1rem;
            border-radius: 3rem;
            font-size: 0.9rem;
        }
        .duration-control input {
            width: 70px;
            padding: 0.3rem;
            border-radius: 2rem;
            border: 1px solid #cbd5e1;
            text-align: center;
        }
        .notes-list {
            list-style: none;
            max-height: 350px;
            overflow-y: auto;
            margin: 0.5rem 0;
        }
        .note-item {
            background: white;
            border-radius: 0.8rem;
            padding: 0.7rem 1rem;
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            gap: 0.8rem;
            border-left: 5px solid #3b82f6;
            margin-bottom: 0.5rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.03);
        }
        .note-time {
            font-family: monospace;
            background: #e9edf2;
            padding: 0.2rem 1rem;
            border-radius: 2rem;
            font-size: 0.8rem;
        }
        .note-text { flex: 2; word-break: break-word; font-size: 0.95rem; }
        .delete-note {
            background: none;
            border: none;
            font-size: 1.4rem;
            color: #b91c1c;
            cursor: pointer;
            padding: 0 0.3rem;
        }
        .footer-info {
            text-align: center;
            font-size: 0.85rem;
            color: #5f6c80;
            margin-top: 0.5rem;
        }
        hr { margin: 0.8rem 0; opacity: 0.2; }
        .file-input, .youtube-input {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            align-items: center;
            margin-bottom: 1rem;
        }
        .file-input input, .youtube-input input {
            flex: 2;
            min-width: 200px;
            padding: 0.6rem 1rem;
            border-radius: 3rem;
            border: 1px solid #cbd5e1;
        }

        /* MODAL */
        .modal {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(0,0,0,0.5);
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        .modal.active {
            display: flex;
        }
        .modal-content {
            background: white;
            border-radius: 2rem;
            padding: 2rem;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
        }
        .modal-content h2 {
            margin-bottom: 1rem;
            color: #1e2b3a;
        }
        .modal-content textarea {
            width: 100%;
            height: 120px;
            padding: 1rem;
            border-radius: 1.5rem;
            border: 2px solid #e2e8f0;
            font-size: 1rem;
            resize: vertical;
            margin-bottom: 1rem;
        }
        .modal-actions {
            display: flex;
            gap: 0.8rem;
            justify-content: flex-end;
        }
        .modal-actions button {
            min-width: 100px;
        }
        .speech-btn {
            background: #10b981;
            color: white;
            border: none;
            margin-right: auto;
        }
        .speech-btn.listening {
            background: #ef4444;
            animation: pulse 1.5s infinite;
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        /* ButonlarÄ± yan yana */
        .action-buttons {
            display: flex;
            gap: 0.8rem;
            width: 100%;
        }
        .action-buttons button {
            flex: 1;
        }

        @media (max-width: 800px) {
            .split-panel { flex-direction: column; }
            .video-area {
                flex: 1 1 auto;
                width: 100%;
            }
            .notes-area { max-height: none; }
            #cameraTab .live-container,
            #cameraTab .player-container {
                max-width: 100%;
            }
            .section-header { flex-wrap: wrap; gap: 0.5rem; }
            .header { flex-direction: column; align-items: stretch; }
            .tabs { justify-content: center; }
            
            .camera-dropdown {
                width: 240px;
                max-height: 200px;
            }
            
            .camera-option {
                padding: 8px 10px;
            }
            
            .camera-selector-btn {
                width: 40px;
                height: 40px;
            }
        }
    </style>
</head>
<body>
<div class="container">
    <!-- Ãœst satÄ±r: sekmeler ve dil seÃ§ici yan yana -->
    <div class="header">
        <!-- Sekmeler -->
        <div class="tabs" id="tabContainer">
            <button class="tab-btn active" data-tab="camera" id="tabCamera">ğŸ“¸ CanlÄ± YayÄ±n</button>
            <button class="tab-btn" data-tab="file" id="tabFile">ğŸ“ Dosya YÃ¼kle</button>
            <button class="tab-btn" data-tab="youtube" id="tabYoutube">â–¶ï¸ YouTube</button>
        </div>
        <!-- Dil seÃ§ici -->
        <div class="lang-selector">
            <span id="lang-label" style="color: #4b5565;">ğŸŒ Dil / Language:</span>
            <select id="langSelect">
                <option value="tr">TÃ¼rkÃ§e</option>
                <option value="en">English</option>
                <option value="ru">Ğ ÑƒÑÑĞºĞ¸Ğ¹</option>
                <option value="ar">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
                <option value="fr">FranÃ§ais</option>
            </select>
        </div>
    </div>

    <!-- CANLI YAYIN TAB'Ä° -->
    <div id="cameraTab" class="tab-content active">
        <div class="split-panel">
            <div class="video-area">
                <div class="section-header">
                    <h3 id="cameraLiveTitle">ğŸ”´ CanlÄ± Kamera</h3>
                    <button id="recordToggleBtn" class="primary">âº Kaydet</button>
                </div>
                <div class="live-container">
                    <video id="liveCamera" autoplay playsinline muted></video>
                    
                    <!-- KAMERA SEÃ‡Ä°CÄ° DROPDOWN -->
                    <div class="camera-selector">
                        <div class="camera-selector-btn" id="cameraSelectorBtn" title="Kamera seÃ§">
                            <svg viewBox="0 0 24 24">
                                <path d="M20 5h-3.17L15 3H9L7.17 5H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 14H4V7h4.05l1.83-2h4.24L16.05 7H20v12zM12 9c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zm0 8c-1.65 0-3-1.35-3-3s1.35-3 3-3 3 1.35 3 3-1.35 3-3 3z"/>
                            </svg>
                        </div>
                        <div class="camera-dropdown" id="cameraDropdown">
                            <div class="no-cameras-message">Kameralar yÃ¼kleniyor...</div>
                        </div>
                    </div>
                </div>
                <div class="section-header" style="margin-top: 0.5rem;">
                    <h3 id="recordedVideoTitle">ğŸ¥ Kaydedilen Video</h3>
                    <button id="clearRecordedBtn" class="warning" style="padding: 0.4rem 1rem;">ğŸ—‘ï¸ Temizle</button>
                </div>
                <div class="player-container">
                    <video id="recordedVideo" controls></video>
                </div>
            </div>
            <div class="notes-area">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <h3 id="notesTitle">ğŸ“Œ Notlar (<span id="noteCount">0</span>)</h3>
                    <button id="clearNotesBtn" style="background:#e9eef5;">ğŸ§¹ Temizle</button>
                </div>
                <div class="duration-control">
                    <span id="durationLabel">â±ï¸ SÃ¼re:</span>
                    <input type="number" id="noteDuration" min="0.5" max="10" step="0.5" value="3">
                    <span id="durationSec">sn</span>
                </div>
                <div class="action-buttons">
                    <button id="addNoteBtn" class="primary" style="flex:1;">ğŸ“ Not Ekle</button>
                    <button id="finishBtn" class="warning" style="flex:1;">ğŸ Bitir & ZIP indir</button>
                </div>
                <ul id="notesList" class="notes-list">
                    <li style="color:#94a3b8; text-align:center;" id="noNotesPlaceholder">HenÃ¼z not eklenmedi.</li>
                </ul>
                <div class="footer-info" id="footerInfo">Notlar .vtt altyazÄ± olarak kaydedilir.</div>
            </div>
        </div>
    </div>

    <!-- DOSYA YÃœKLE TAB'Ä° -->
    <div id="fileTab" class="tab-content">
        <div class="file-input">
            <input type="file" id="fileUpload" accept="video/*">
            <button id="loadFileBtn">ğŸ“‚ YÃ¼kle ve Oynat</button>
        </div>
        <div class="split-panel">
            <div class="video-area">
                <h3 id="fileVideoTitle">ğŸ“ YÃ¼klenen Video</h3>
                <div class="player-container">
                    <video id="recordedVideoFile" controls></video>
                </div>
            </div>
            <div class="notes-area">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <h3 id="notesTitleFile">ğŸ“Œ Notlar (<span id="noteCountFile">0</span>)</h3>
                    <button id="clearNotesBtnFile" style="background:#e9eef5;">ğŸ§¹ Temizle</button>
                </div>
                <div class="duration-control">
                    <span id="durationLabelFile">â±ï¸ SÃ¼re:</span>
                    <input type="number" id="noteDurationFile" min="0.5" max="10" step="0.5" value="3">
                    <span id="durationSecFile">sn</span>
                </div>
                <div class="action-buttons">
                    <button id="addNoteBtnFile" class="primary" style="flex:1;">ğŸ“ Not Ekle</button>
                    <button id="finishBtnFile" class="warning" style="flex:1;">ğŸ Bitir & ZIP indir</button>
                </div>
                <ul id="notesListFile" class="notes-list">
                    <li style="color:#94a3b8; text-align:center;" id="noNotesPlaceholderFile">HenÃ¼z not eklenmedi.</li>
                </ul>
                <div class="footer-info" id="footerInfoFile">Notlar .vtt altyazÄ± olarak kaydedilir.</div>
            </div>
        </div>
    </div>

    <!-- YOUTUBE TAB'Ä° -->
    <div id="youtubeTab" class="tab-content">
        <div class="youtube-input">
            <input type="text" id="youtubeInput" placeholder="Video ID veya link (Ã¶r: dQw4w9WgXcQ)">
            <button id="loadYoutubeBtn">â–¶ï¸ YÃ¼kle</button>
        </div>
        <div class="split-panel">
            <div class="video-area">
                <h3 id="youtubeVideoTitle">â–¶ï¸ YouTube Video</h3>
                <div class="player-container">
                    <div id="youtubeContainerYt"></div>
                </div>
            </div>
            <div class="notes-area">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <h3 id="notesTitleYt">ğŸ“Œ Notlar (<span id="noteCountYt">0</span>)</h3>
                    <button id="clearNotesBtnYt" style="background:#e9eef5;">ğŸ§¹ Temizle</button>
                </div>
                <div class="duration-control">
                    <span id="durationLabelYt">â±ï¸ SÃ¼re:</span>
                    <input type="number" id="noteDurationYt" min="0.5" max="10" step="0.5" value="3">
                    <span id="durationSecYt">sn</span>
                </div>
                <div class="action-buttons">
                    <button id="addNoteBtnYt" class="primary" style="flex:1;">ğŸ“ Not Ekle</button>
                    <button id="finishBtnYt" class="warning" style="flex:1;">ğŸ Bitir & ZIP indir</button>
                </div>
                <ul id="notesListYt" class="notes-list">
                    <li style="color:#94a3b8; text-align:center;" id="noNotesPlaceholderYt">HenÃ¼z not eklenmedi.</li>
                </ul>
                <div class="footer-info" id="footerInfoYt">YouTube'da video dosyasÄ± eklenmez, sadece altyazÄ± indirilir.</div>
            </div>
        </div>
    </div>
</div>

<!-- NOT EKLEME MODALI (sesli yazma Ã¶zellikli) -->
<div id="noteModal" class="modal">
    <div class="modal-content">
        <h2 id="modalTitle">ğŸ“ Not Ekle</h2>
        <textarea id="noteTextInput" placeholder="Notunuzu yazÄ±n veya mikrofon butonuna basÄ±p konuÅŸun..."></textarea>
        <div style="display: flex; gap: 0.8rem; align-items: center;">
            <button id="speechBtn" class="speech-btn">ğŸ¤ Sesle Yaz</button>
            <div style="flex:1"></div>
            <button id="modalCancelBtn">Ä°ptal</button>
            <button id="modalSaveBtn" class="primary">Kaydet</button>
        </div>
    </div>
</div>

<script>
(function() {
    // ----- Ã‡EVÄ°RÄ° SÃ–ZLÃœÄÃœ -----
    const translations = {
        tr: {
            tabCamera: "ğŸ“¸ CanlÄ± YayÄ±n",
            tabFile: "ğŸ“ Dosya YÃ¼kle",
            tabYoutube: "â–¶ï¸ YouTube",
            cameraLiveTitle: "ğŸ”´ CanlÄ± Kamera",
            recordToggleStart: "âº Kaydet",
            recordToggleStop: "â¹ Durdur",
            recordedVideoTitle: "ğŸ¥ Kaydedilen Video",
            clearRecordedBtn: "ğŸ—‘ï¸ Temizle",
            notesTitle: "ğŸ“Œ Notlar",
            clearNotesBtn: "ğŸ§¹ Temizle",
            durationLabel: "â±ï¸ SÃ¼re:",
            durationSec: "sn",
            addNoteBtn: "ğŸ“ Not Ekle",
            finishBtn: "ğŸ Bitir & ZIP indir",
            noNotesPlaceholder: "HenÃ¼z not eklenmedi.",
            footerInfo: "Notlar .vtt altyazÄ± olarak kaydedilir.",
            fileVideoTitle: "ğŸ“ YÃ¼klenen Video",
            loadFileBtn: "ğŸ“‚ YÃ¼kle ve Oynat",
            youtubeVideoTitle: "â–¶ï¸ YouTube Video",
            youtubeInputPlaceholder: "Video ID veya link (Ã¶r: dQw4w9WgXcQ)",
            loadYoutubeBtn: "â–¶ï¸ YÃ¼kle",
            footerInfoYt: "YouTube'da video dosyasÄ± eklenmez, sadece altyazÄ± indirilir.",
            modalTitle: "ğŸ“ Not Ekle",
            noteTextPlaceholder: "Notunuzu yazÄ±n veya mikrofon butonuna basÄ±p konuÅŸun...",
            speechBtn: "ğŸ¤ Sesle Yaz",
            listeningBtn: "â¹ï¸ Dinliyor...",
            modalCancel: "Ä°ptal",
            modalSave: "Kaydet",
            // Kamera seÃ§ici Ã§evirileri
            cameraSelectTitle: "Kamera seÃ§",
            cameraSelectDisabled: "KayÄ±t sÄ±rasÄ±nda kamera deÄŸiÅŸmez",
            loadingCameras: "Kameralar yÃ¼kleniyor...",
            noCamerasFound: "Kamera bulunamadÄ±",
            frontCamera: "Ã–n",
            backCamera: "Arka",
            externalCamera: "Harici",
            // UyarÄ± mesajlarÄ±
            alertNoCamera: "Kamera/mikrofon izni gerekli: ",
            alertNoStream: "Kamera akÄ±ÅŸÄ± yok",
            alertNewRecordClear: "Yeni kayÄ±t mevcut notlarÄ± temizlesin?",
            alertRecVideoNotFound: "CanlÄ± kayÄ±t videosu yok. Ã–nce kayÄ±t yapÄ±p durdurun.",
            alertFileNotFound: "Dosya yÃ¼klenmemiÅŸ.",
            alertYoutubeNotFound: "YouTube videosu yÃ¼klenmemiÅŸ.",
            alertTimeError: "Zaman alÄ±namadÄ±.",
            alertNoteEmpty: "Not boÅŸ olamaz.",
            alertError: "Bir hata oluÅŸtu.",
            alertConfirmClearNotes: "TÃ¼m notlar silinsin mi?",
            alertYoutubeNoVideo: "YouTube kaynaÄŸÄ±nda video dosyasÄ± eklenemiyor, sadece altyazÄ± indirilecek.",
            alertNoVideoBlob: "Video blobu bulunamadÄ±, sadece altyazÄ± indiriliyor.",
            alertSelectFile: "Dosya seÃ§in",
            alertValidYoutubeId: "GeÃ§erli bir YouTube video IDâ€™si veya linki girin.",
        },
        en: {
            tabCamera: "ğŸ“¸ Live Camera",
            tabFile: "ğŸ“ Upload File",
            tabYoutube: "â–¶ï¸ YouTube",
            cameraLiveTitle: "ğŸ”´ Live Camera",
            recordToggleStart: "âº Record",
            recordToggleStop: "â¹ Stop",
            recordedVideoTitle: "ğŸ¥ Recorded Video",
            clearRecordedBtn: "ğŸ—‘ï¸ Clear",
            notesTitle: "ğŸ“Œ Notes",
            clearNotesBtn: "ğŸ§¹ Clear",
            durationLabel: "â±ï¸ Duration:",
            durationSec: "sec",
            addNoteBtn: "ğŸ“ Add Note",
            finishBtn: "ğŸ Finish & Download ZIP",
            noNotesPlaceholder: "No notes yet.",
            footerInfo: "Notes are saved as .vtt subtitles.",
            fileVideoTitle: "ğŸ“ Uploaded Video",
            loadFileBtn: "ğŸ“‚ Load and Play",
            youtubeVideoTitle: "â–¶ï¸ YouTube Video",
            youtubeInputPlaceholder: "Video ID or link (e.g., dQw4w9WgXcQ)",
            loadYoutubeBtn: "â–¶ï¸ Load",
            footerInfoYt: "Video file is not included for YouTube, only subtitles.",
            modalTitle: "ğŸ“ Add Note",
            noteTextPlaceholder: "Write your note or press the microphone button and speak...",
            speechBtn: "ğŸ¤ Voice Typing",
            listeningBtn: "â¹ï¸ Listening...",
            modalCancel: "Cancel",
            modalSave: "Save",
            // Camera selector translations
            cameraSelectTitle: "Select camera",
            cameraSelectDisabled: "Cannot switch while recording",
            loadingCameras: "Loading cameras...",
            noCamerasFound: "No cameras found",
            frontCamera: "Front",
            backCamera: "Back",
            externalCamera: "External",
            // Alert messages
            alertNoCamera: "Camera/microphone permission required: ",
            alertNoStream: "No camera stream",
            alertNewRecordClear: "New recording, clear existing notes?",
            alertRecVideoNotFound: "No recorded video. Please record first.",
            alertFileNotFound: "No file uploaded.",
            alertYoutubeNotFound: "No YouTube video loaded.",
            alertTimeError: "Could not get current time.",
            alertNoteEmpty: "Note cannot be empty.",
            alertError: "An error occurred.",
            alertConfirmClearNotes: "Delete all notes?",
            alertYoutubeNoVideo: "Video file cannot be added for YouTube, only subtitles will be downloaded.",
            alertNoVideoBlob: "No video blob found, only subtitles will be downloaded.",
            alertSelectFile: "Please select a file",
            alertValidYoutubeId: "Please enter a valid YouTube video ID or link.",
        },
        ru: {
            tabCamera: "ğŸ“¸ ĞŸÑ€ÑĞ¼Ğ¾Ğ¹ ÑÑ„Ğ¸Ñ€",
            tabFile: "ğŸ“ Ğ—Ğ°Ğ³Ñ€ÑƒĞ·Ğ¸Ñ‚ÑŒ Ñ„Ğ°Ğ¹Ğ»",
            tabYoutube: "â–¶ï¸ YouTube",
            cameraLiveTitle: "ğŸ”´ ĞŸÑ€ÑĞ¼Ğ°Ñ ĞºĞ°Ğ¼ĞµÑ€Ğ°",
            recordToggleStart: "âº Ğ—Ğ°Ğ¿Ğ¸ÑÑŒ",
            recordToggleStop: "â¹ Ğ¡Ñ‚Ğ¾Ğ¿",
            recordedVideoTitle: "ğŸ¥ Ğ—Ğ°Ğ¿Ğ¸ÑĞ°Ğ½Ğ½Ğ¾Ğµ Ğ²Ğ¸Ğ´ĞµĞ¾",
            clearRecordedBtn: "ğŸ—‘ï¸ ĞÑ‡Ğ¸ÑÑ‚Ğ¸Ñ‚ÑŒ",
            notesTitle: "ğŸ“Œ Ğ—Ğ°Ğ¼ĞµÑ‚ĞºĞ¸",
            clearNotesBtn: "ğŸ§¹ ĞÑ‡Ğ¸ÑÑ‚Ğ¸Ñ‚ÑŒ",
            durationLabel: "â±ï¸ Ğ”Ğ»Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ:",
            durationSec: "ÑĞµĞº",
            addNoteBtn: "ğŸ“ Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ·Ğ°Ğ¼ĞµÑ‚ĞºÑƒ",
            finishBtn: "ğŸ Ğ“Ğ¾Ñ‚Ğ¾Ğ²Ğ¾ Ğ¸ ÑĞºĞ°Ñ‡Ğ°Ñ‚ÑŒ ZIP",
            noNotesPlaceholder: "Ğ—Ğ°Ğ¼ĞµÑ‚Ğ¾Ğº Ğ¿Ğ¾ĞºĞ° Ğ½ĞµÑ‚.",
            footerInfo: "Ğ—Ğ°Ğ¼ĞµÑ‚ĞºĞ¸ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ÑÑÑ‚ÑÑ ĞºĞ°Ğº ÑÑƒĞ±Ñ‚Ğ¸Ñ‚Ñ€Ñ‹ .vtt.",
            fileVideoTitle: "ğŸ“ Ğ—Ğ°Ğ³Ñ€ÑƒĞ¶ĞµĞ½Ğ½Ğ¾Ğµ Ğ²Ğ¸Ğ´ĞµĞ¾",
            loadFileBtn: "ğŸ“‚ Ğ—Ğ°Ğ³Ñ€ÑƒĞ·Ğ¸Ñ‚ÑŒ Ğ¸ Ğ²Ğ¾ÑĞ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²ĞµÑÑ‚Ğ¸",
            youtubeVideoTitle: "â–¶ï¸ YouTube Ğ²Ğ¸Ğ´ĞµĞ¾",
            youtubeInputPlaceholder: "ID Ğ²Ğ¸Ğ´ĞµĞ¾ Ğ¸Ğ»Ğ¸ ÑÑÑ‹Ğ»ĞºĞ° (Ğ½Ğ°Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€, dQw4w9WgXcQ)",
            loadYoutubeBtn: "â–¶ï¸ Ğ—Ğ°Ğ³Ñ€ÑƒĞ·Ğ¸Ñ‚ÑŒ",
            footerInfoYt: "Ğ’Ğ¸Ğ´ĞµĞ¾Ñ„Ğ°Ğ¹Ğ» Ğ½Ğµ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ÑĞµÑ‚ÑÑ Ğ´Ğ»Ñ YouTube, Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ ÑÑƒĞ±Ñ‚Ğ¸Ñ‚Ñ€Ñ‹.",
            modalTitle: "ğŸ“ Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ·Ğ°Ğ¼ĞµÑ‚ĞºÑƒ",
            noteTextPlaceholder: "ĞĞ°Ğ¿Ğ¸ÑˆĞ¸Ñ‚Ğµ Ğ·Ğ°Ğ¼ĞµÑ‚ĞºÑƒ Ğ¸Ğ»Ğ¸ Ğ½Ğ°Ğ¶Ğ¼Ğ¸Ñ‚Ğµ ĞºĞ½Ğ¾Ğ¿ĞºÑƒ Ğ¼Ğ¸ĞºÑ€Ğ¾Ñ„Ğ¾Ğ½Ğ° Ğ¸ Ğ³Ğ¾Ğ²Ğ¾Ñ€Ğ¸Ñ‚Ğµ...",
            speechBtn: "ğŸ¤ Ğ“Ğ¾Ğ»Ğ¾ÑĞ¾Ğ²Ğ¾Ğ¹ Ğ²Ğ²Ğ¾Ğ´",
            listeningBtn: "â¹ï¸ Ğ¡Ğ»ÑƒÑˆĞ°Ñ...",
            modalCancel: "ĞÑ‚Ğ¼ĞµĞ½Ğ°",
            modalSave: "Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒ",
            cameraSelectTitle: "Ğ’Ñ‹Ğ±Ñ€Ğ°Ñ‚ÑŒ ĞºĞ°Ğ¼ĞµÑ€Ñƒ",
            cameraSelectDisabled: "ĞĞµĞ»ÑŒĞ·Ñ ÑĞ¼ĞµĞ½Ğ¸Ñ‚ÑŒ Ğ²Ğ¾ Ğ²Ñ€ĞµĞ¼Ñ Ğ·Ğ°Ğ¿Ğ¸ÑĞ¸",
            loadingCameras: "Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° ĞºĞ°Ğ¼ĞµÑ€...",
            noCamerasFound: "ĞšĞ°Ğ¼ĞµÑ€Ñ‹ Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ñ‹",
            frontCamera: "ĞŸĞµÑ€ĞµĞ´Ğ½ÑÑ",
            backCamera: "Ğ—Ğ°Ğ´Ğ½ÑÑ",
            externalCamera: "Ğ’Ğ½ĞµÑˆĞ½ÑÑ",
            // Alert messages
            alertNoCamera: "Ğ¢Ñ€ĞµĞ±ÑƒĞµÑ‚ÑÑ Ñ€Ğ°Ğ·Ñ€ĞµÑˆĞµĞ½Ğ¸Ğµ ĞºĞ°Ğ¼ĞµÑ€Ñ‹/Ğ¼Ğ¸ĞºÑ€Ğ¾Ñ„Ğ¾Ğ½Ğ°: ",
            alertNoStream: "ĞĞµÑ‚ Ğ¿Ğ¾Ñ‚Ğ¾ĞºĞ° ĞºĞ°Ğ¼ĞµÑ€Ñ‹",
            alertNewRecordClear: "ĞĞ¾Ğ²Ğ°Ñ Ğ·Ğ°Ğ¿Ğ¸ÑÑŒ, Ğ¾Ñ‡Ğ¸ÑÑ‚Ğ¸Ñ‚ÑŒ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ğµ Ğ·Ğ°Ğ¼ĞµÑ‚ĞºĞ¸?",
            alertRecVideoNotFound: "ĞĞµÑ‚ Ğ·Ğ°Ğ¿Ğ¸ÑĞ°Ğ½Ğ½Ğ¾Ğ³Ğ¾ Ğ²Ğ¸Ğ´ĞµĞ¾. Ğ¡Ğ½Ğ°Ñ‡Ğ°Ğ»Ğ° ÑĞ´ĞµĞ»Ğ°Ğ¹Ñ‚Ğµ Ğ·Ğ°Ğ¿Ğ¸ÑÑŒ.",
            alertFileNotFound: "Ğ¤Ğ°Ğ¹Ğ» Ğ½Ğµ Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶ĞµĞ½.",
            alertYoutubeNotFound: "YouTube Ğ²Ğ¸Ğ´ĞµĞ¾ Ğ½Ğµ Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶ĞµĞ½Ğ¾.",
            alertTimeError: "ĞĞµ ÑƒĞ´Ğ°Ğ»Ğ¾ÑÑŒ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ñ‚ĞµĞºÑƒÑ‰ĞµĞµ Ğ²Ñ€ĞµĞ¼Ñ.",
            alertNoteEmpty: "Ğ—Ğ°Ğ¼ĞµÑ‚ĞºĞ° Ğ½Ğµ Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ±Ñ‹Ñ‚ÑŒ Ğ¿ÑƒÑÑ‚Ğ¾Ğ¹.",
            alertError: "ĞŸÑ€Ğ¾Ğ¸Ğ·Ğ¾ÑˆĞ»Ğ° Ğ¾ÑˆĞ¸Ğ±ĞºĞ°.",
            alertConfirmClearNotes: "Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ Ğ²ÑĞµ Ğ·Ğ°Ğ¼ĞµÑ‚ĞºĞ¸?",
            alertYoutubeNoVideo: "Ğ’Ğ¸Ğ´ĞµĞ¾Ñ„Ğ°Ğ¹Ğ» Ğ½Ğµ Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ±Ñ‹Ñ‚ÑŒ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½ Ğ´Ğ»Ñ YouTube, Ğ±ÑƒĞ´ÑƒÑ‚ Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶ĞµĞ½Ñ‹ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ ÑÑƒĞ±Ñ‚Ğ¸Ñ‚Ñ€Ñ‹.",
            alertNoVideoBlob: "Ğ’Ğ¸Ğ´ĞµĞ¾ Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ğ¾, Ğ±ÑƒĞ´ÑƒÑ‚ Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶ĞµĞ½Ñ‹ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ ÑÑƒĞ±Ñ‚Ğ¸Ñ‚Ñ€Ñ‹.",
            alertSelectFile: "ĞŸĞ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°, Ğ²Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ Ñ„Ğ°Ğ¹Ğ»",
            alertValidYoutubeId: "ĞŸĞ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°, Ğ²Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğ¹ ID Ğ²Ğ¸Ğ´ĞµĞ¾ YouTube Ğ¸Ğ»Ğ¸ ÑÑÑ‹Ğ»ĞºÑƒ.",
        },
        ar: {
            tabCamera: "ğŸ“¸ ÙƒØ§Ù…ÙŠØ±Ø§ Ù…Ø¨Ø§Ø´Ø±Ø©",
            tabFile: "ğŸ“ Ø±ÙØ¹ Ù…Ù„Ù",
            tabYoutube: "â–¶ï¸ ÙŠÙˆØªÙŠÙˆØ¨",
            cameraLiveTitle: "ğŸ”´ ÙƒØ§Ù…ÙŠØ±Ø§ Ù…Ø¨Ø§Ø´Ø±Ø©",
            recordToggleStart: "âº ØªØ³Ø¬ÙŠÙ„",
            recordToggleStop: "â¹ Ø¥ÙŠÙ‚Ø§Ù",
            recordedVideoTitle: "ğŸ¥ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø§Ù„Ù…Ø³Ø¬Ù„",
            clearRecordedBtn: "ğŸ—‘ï¸ Ù…Ø³Ø­",
            notesTitle: "ğŸ“Œ Ù…Ù„Ø§Ø­Ø¸Ø§Øª",
            clearNotesBtn: "ğŸ§¹ Ù…Ø³Ø­",
            durationLabel: "â±ï¸ Ø§Ù„Ù…Ø¯Ø©:",
            durationSec: "Ø«Ø§Ù†ÙŠØ©",
            addNoteBtn: "ğŸ“ Ø¥Ø¶Ø§ÙØ© Ù…Ù„Ø§Ø­Ø¸Ø©",
            finishBtn: "ğŸ Ø¥Ù†Ù‡Ø§Ø¡ ÙˆØªØ­Ù…ÙŠÙ„ ZIP",
            noNotesPlaceholder: "Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¨Ø¹Ø¯.",
            footerInfo: "ÙŠØªÙ… Ø­ÙØ¸ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª ÙƒØªØ±Ø¬Ù…Ø© .vtt.",
            fileVideoTitle: "ğŸ“ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø§Ù„Ù…Ø±ÙÙˆØ¹",
            loadFileBtn: "ğŸ“‚ ØªØ­Ù…ÙŠÙ„ ÙˆØªØ´ØºÙŠÙ„",
            youtubeVideoTitle: "â–¶ï¸ ÙÙŠØ¯ÙŠÙˆ ÙŠÙˆØªÙŠÙˆØ¨",
            youtubeInputPlaceholder: "Ù…Ø¹Ø±Ù Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø£Ùˆ Ø§Ù„Ø±Ø§Ø¨Ø· (Ù…Ø«Ø§Ù„: dQw4w9WgXcQ)",
            loadYoutubeBtn: "â–¶ï¸ ØªØ­Ù…ÙŠÙ„",
            footerInfoYt: "Ù…Ù„Ù Ø§Ù„ÙÙŠØ¯ÙŠÙˆ ØºÙŠØ± Ù…Ø¶Ø§Ù Ù„Ù„ÙŠÙˆØªÙŠÙˆØ¨ØŒ ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØ±Ø¬Ù…Ø© ÙÙ‚Ø·.",
            modalTitle: "ğŸ“ Ø¥Ø¶Ø§ÙØ© Ù…Ù„Ø§Ø­Ø¸Ø©",
            noteTextPlaceholder: "Ø§ÙƒØªØ¨ Ù…Ù„Ø§Ø­Ø¸ØªÙƒ Ø£Ùˆ Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± Ø§Ù„Ù…ÙŠÙƒØ±ÙˆÙÙˆÙ† ÙˆØªØ­Ø¯Ø«...",
            speechBtn: "ğŸ¤ ÙƒØªØ§Ø¨Ø© ØµÙˆØªÙŠØ©",
            listeningBtn: "â¹ï¸ Ø§Ø³ØªÙ…Ø§Ø¹...",
            modalCancel: "Ø¥Ù„ØºØ§Ø¡",
            modalSave: "Ø­ÙØ¸",
            cameraSelectTitle: "Ø§Ø®ØªØ± Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§",
            cameraSelectDisabled: "Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªØ³Ø¬ÙŠÙ„",
            loadingCameras: "Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§Øª...",
            noCamerasFound: "Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ÙƒØ§Ù…ÙŠØ±Ø§Øª",
            frontCamera: "Ø£Ù…Ø§Ù…ÙŠØ©",
            backCamera: "Ø®Ù„ÙÙŠØ©",
            externalCamera: "Ø®Ø§Ø±Ø¬ÙŠØ©",
            // Alert messages
            alertNoCamera: "Ø¥Ø°Ù† Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§/Ø§Ù„Ù…ÙŠÙƒØ±ÙˆÙÙˆÙ† Ù…Ø·Ù„ÙˆØ¨: ",
            alertNoStream: "Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¨Ø« ÙƒØ§Ù…ÙŠØ±Ø§",
            alertNewRecordClear: "ØªØ³Ø¬ÙŠÙ„ Ø¬Ø¯ÙŠØ¯ØŒ Ù‡Ù„ ØªØ±ÙŠØ¯ Ù…Ø³Ø­ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©ØŸ",
            alertRecVideoNotFound: "Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙÙŠØ¯ÙŠÙˆ Ù…Ø³Ø¬Ù„. ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø£ÙˆÙ„Ø§Ù‹.",
            alertFileNotFound: "Ù„Ù… ÙŠØªÙ… Ø±ÙØ¹ Ù…Ù„Ù.",
            alertYoutubeNotFound: "Ù„Ù… ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ ÙÙŠØ¯ÙŠÙˆ ÙŠÙˆØªÙŠÙˆØ¨.",
            alertTimeError: "ØªØ¹Ø°Ø± Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø­Ø§Ù„ÙŠ.",
            alertNoteEmpty: "Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø£Ù† ØªÙƒÙˆÙ† Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø© ÙØ§Ø±ØºØ©.",
            alertError: "Ø­Ø¯Ø« Ø®Ø·Ø£.",
            alertConfirmClearNotes: "Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§ØªØŸ",
            alertYoutubeNoVideo: "Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø¥Ø¶Ø§ÙØ© Ù…Ù„Ù ÙÙŠØ¯ÙŠÙˆ Ù„ÙŠÙˆØªÙŠÙˆØ¨ØŒ Ø³ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØ±Ø¬Ù…Ø© ÙÙ‚Ø·.",
            alertNoVideoBlob: "Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ÙÙŠØ¯ÙŠÙˆØŒ Ø³ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØ±Ø¬Ù…Ø© ÙÙ‚Ø·.",
            alertSelectFile: "Ø§Ù„Ø±Ø¬Ø§Ø¡ ØªØ­Ø¯ÙŠØ¯ Ù…Ù„Ù",
            alertValidYoutubeId: "Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¹Ø±Ù ÙÙŠØ¯ÙŠÙˆ ÙŠÙˆØªÙŠÙˆØ¨ ØµØ§Ù„Ø­ Ø£Ùˆ Ø±Ø§Ø¨Ø·.",
        },
        fr: {
            tabCamera: "ğŸ“¸ CamÃ©ra en direct",
            tabFile: "ğŸ“ TÃ©lÃ©charger un fichier",
            tabYoutube: "â–¶ï¸ YouTube",
            cameraLiveTitle: "ğŸ”´ CamÃ©ra en direct",
            recordToggleStart: "âº Enregistrer",
            recordToggleStop: "â¹ ArrÃªter",
            recordedVideoTitle: "ğŸ¥ VidÃ©o enregistrÃ©e",
            clearRecordedBtn: "ğŸ—‘ï¸ Effacer",
            notesTitle: "ğŸ“Œ Notes",
            clearNotesBtn: "ğŸ§¹ Effacer",
            durationLabel: "â±ï¸ DurÃ©e:",
            durationSec: "sec",
            addNoteBtn: "ğŸ“ Ajouter une note",
            finishBtn: "ğŸ Terminer et tÃ©lÃ©charger ZIP",
            noNotesPlaceholder: "Aucune note pour l'instant.",
            footerInfo: "Les notes sont enregistrÃ©es sous forme de sous-titres .vtt.",
            fileVideoTitle: "ğŸ“ VidÃ©o tÃ©lÃ©chargÃ©e",
            loadFileBtn: "ğŸ“‚ Charger et lire",
            youtubeVideoTitle: "â–¶ï¸ VidÃ©o YouTube",
            youtubeInputPlaceholder: "ID de la vidÃ©o ou lien (ex: dQw4w9WgXcQ)",
            loadYoutubeBtn: "â–¶ï¸ Charger",
            footerInfoYt: "Le fichier vidÃ©o n'est pas inclus pour YouTube, seulement les sous-titres.",
            modalTitle: "ğŸ“ Ajouter une note",
            noteTextPlaceholder: "Ã‰crivez votre note ou appuyez sur le bouton micro et parlez...",
            speechBtn: "ğŸ¤ Saisie vocale",
            listeningBtn: "â¹ï¸ Ã‰coute...",
            modalCancel: "Annuler",
            modalSave: "Enregistrer",
            cameraSelectTitle: "Choisir la camÃ©ra",
            cameraSelectDisabled: "Impossible de changer pendant l'enregistrement",
            loadingCameras: "Chargement des camÃ©ras...",
            noCamerasFound: "Aucune camÃ©ra trouvÃ©e",
            frontCamera: "Avant",
            backCamera: "ArriÃ¨re",
            externalCamera: "Externe",
            // Alert messages
            alertNoCamera: "Autorisation camÃ©ra/micro requise : ",
            alertNoStream: "Pas de flux camÃ©ra",
            alertNewRecordClear: "Nouvel enregistrement, effacer les notes existantes ?",
            alertRecVideoNotFound: "Aucune vidÃ©o enregistrÃ©e. Veuillez d'abord enregistrer.",
            alertFileNotFound: "Aucun fichier tÃ©lÃ©chargÃ©.",
            alertYoutubeNotFound: "Aucune vidÃ©o YouTube chargÃ©e.",
            alertTimeError: "Impossible d'obtenir le temps actuel.",
            alertNoteEmpty: "La note ne peut pas Ãªtre vide.",
            alertError: "Une erreur est survenue.",
            alertConfirmClearNotes: "Supprimer toutes les notes ?",
            alertYoutubeNoVideo: "Le fichier vidÃ©o ne peut pas Ãªtre ajoutÃ© pour YouTube, seuls les sous-titres seront tÃ©lÃ©chargÃ©s.",
            alertNoVideoBlob: "Aucun blob vidÃ©o trouvÃ©, seuls les sous-titres seront tÃ©lÃ©chargÃ©s.",
            alertSelectFile: "Veuillez sÃ©lectionner un fichier",
            alertValidYoutubeId: "Veuillez entrer un ID de vidÃ©o YouTube ou un lien valide.",
        }
    };

    // Åu anki dil
    let currentLang = 'tr';

    // DOM elementleri (Ã§evrilecek olanlar)
    const elements = {
        tabCamera: document.getElementById('tabCamera'),
        tabFile: document.getElementById('tabFile'),
        tabYoutube: document.getElementById('tabYoutube'),
        cameraLiveTitle: document.getElementById('cameraLiveTitle'),
        recordToggleBtn: document.getElementById('recordToggleBtn'),
        recordedVideoTitle: document.getElementById('recordedVideoTitle'),
        clearRecordedBtn: document.getElementById('clearRecordedBtn'),
        notesTitle: document.querySelector('#notesTitle'),
        clearNotesBtn: document.getElementById('clearNotesBtn'),
        durationLabel: document.getElementById('durationLabel'),
        durationSec: document.getElementById('durationSec'),
        addNoteBtn: document.getElementById('addNoteBtn'),
        finishBtn: document.getElementById('finishBtn'),
        noNotesPlaceholder: document.getElementById('noNotesPlaceholder'),
        footerInfo: document.getElementById('footerInfo'),
        fileVideoTitle: document.getElementById('fileVideoTitle'),
        loadFileBtn: document.getElementById('loadFileBtn'),
        youtubeVideoTitle: document.getElementById('youtubeVideoTitle'),
        youtubeInput: document.getElementById('youtubeInput'),
        loadYoutubeBtn: document.getElementById('loadYoutubeBtn'),
        footerInfoYt: document.getElementById('footerInfoYt'),
        modalTitle: document.getElementById('modalTitle'),
        noteTextInput: document.getElementById('noteTextInput'),
        speechBtn: document.getElementById('speechBtn'),
        modalCancelBtn: document.getElementById('modalCancelBtn'),
        modalSaveBtn: document.getElementById('modalSaveBtn'),
        // DiÄŸer sekmeler
        notesTitleFile: document.getElementById('notesTitleFile'),
        clearNotesBtnFile: document.getElementById('clearNotesBtnFile'),
        durationLabelFile: document.getElementById('durationLabelFile'),
        durationSecFile: document.getElementById('durationSecFile'),
        addNoteBtnFile: document.getElementById('addNoteBtnFile'),
        finishBtnFile: document.getElementById('finishBtnFile'),
        noNotesPlaceholderFile: document.getElementById('noNotesPlaceholderFile'),
        footerInfoFile: document.getElementById('footerInfoFile'),
        notesTitleYt: document.getElementById('notesTitleYt'),
        clearNotesBtnYt: document.getElementById('clearNotesBtnYt'),
        durationLabelYt: document.getElementById('durationLabelYt'),
        durationSecYt: document.getElementById('durationSecYt'),
        addNoteBtnYt: document.getElementById('addNoteBtnYt'),
        finishBtnYt: document.getElementById('finishBtnYt'),
        noNotesPlaceholderYt: document.getElementById('noNotesPlaceholderYt'),
        footerInfoYt: document.getElementById('footerInfoYt'),
        langLabel: document.getElementById('lang-label'),
        cameraSelectorBtn: document.getElementById('cameraSelectorBtn'),
    };

    // Ã‡eviri fonksiyonu
    function translatePage(lang) {
        const t = translations[lang];
        if (!t) return;

        if (elements.tabCamera) elements.tabCamera.textContent = t.tabCamera;
        if (elements.tabFile) elements.tabFile.textContent = t.tabFile;
        if (elements.tabYoutube) elements.tabYoutube.textContent = t.tabYoutube;
        if (elements.cameraLiveTitle) elements.cameraLiveTitle.textContent = t.cameraLiveTitle;
        if (elements.recordToggleBtn) {
            if (isRecording) {
                elements.recordToggleBtn.textContent = t.recordToggleStop;
            } else {
                elements.recordToggleBtn.textContent = t.recordToggleStart;
            }
        }
        if (elements.recordedVideoTitle) elements.recordedVideoTitle.textContent = t.recordedVideoTitle;
        if (elements.clearRecordedBtn) elements.clearRecordedBtn.textContent = t.clearRecordedBtn;
        if (elements.notesTitle) {
            const countSpan = elements.notesTitle.querySelector('span');
            const count = countSpan ? countSpan.textContent : '0';
            elements.notesTitle.innerHTML = `${t.notesTitle} (<span id="noteCount">${count}</span>)`;
        }
        if (elements.clearNotesBtn) elements.clearNotesBtn.textContent = t.clearNotesBtn;
        if (elements.durationLabel) elements.durationLabel.textContent = t.durationLabel;
        if (elements.durationSec) elements.durationSec.textContent = t.durationSec;
        if (elements.addNoteBtn) elements.addNoteBtn.textContent = t.addNoteBtn;
        if (elements.finishBtn) elements.finishBtn.textContent = t.finishBtn;
        if (elements.noNotesPlaceholder) elements.noNotesPlaceholder.textContent = t.noNotesPlaceholder;
        if (elements.footerInfo) elements.footerInfo.textContent = t.footerInfo;
        if (elements.fileVideoTitle) elements.fileVideoTitle.textContent = t.fileVideoTitle;
        if (elements.loadFileBtn) elements.loadFileBtn.textContent = t.loadFileBtn;
        if (elements.youtubeVideoTitle) elements.youtubeVideoTitle.textContent = t.youtubeVideoTitle;
        if (elements.youtubeInput) elements.youtubeInput.placeholder = t.youtubeInputPlaceholder;
        if (elements.loadYoutubeBtn) elements.loadYoutubeBtn.textContent = t.loadYoutubeBtn;
        if (elements.footerInfoYt) elements.footerInfoYt.textContent = t.footerInfoYt;
        if (elements.modalTitle) elements.modalTitle.textContent = t.modalTitle;
        if (elements.noteTextInput) elements.noteTextInput.placeholder = t.noteTextPlaceholder;
        if (elements.speechBtn) {
            if (elements.speechBtn.classList.contains('listening')) {
                elements.speechBtn.textContent = t.listeningBtn;
            } else {
                elements.speechBtn.textContent = t.speechBtn;
            }
        }
        if (elements.modalCancelBtn) elements.modalCancelBtn.textContent = t.modalCancel;
        if (elements.modalSaveBtn) elements.modalSaveBtn.textContent = t.modalSave;
        if (elements.cameraSelectorBtn) {
            elements.cameraSelectorBtn.title = isRecording ? t.cameraSelectDisabled : t.cameraSelectTitle;
        }

        // DiÄŸer sekme notlarÄ±
        if (elements.notesTitleFile) {
            const countSpan = elements.notesTitleFile.querySelector('span');
            const count = countSpan ? countSpan.textContent : '0';
            elements.notesTitleFile.innerHTML = `${t.notesTitle} (<span id="noteCountFile">${count}</span>)`;
        }
        if (elements.clearNotesBtnFile) elements.clearNotesBtnFile.textContent = t.clearNotesBtn;
        if (elements.durationLabelFile) elements.durationLabelFile.textContent = t.durationLabel;
        if (elements.durationSecFile) elements.durationSecFile.textContent = t.durationSec;
        if (elements.addNoteBtnFile) elements.addNoteBtnFile.textContent = t.addNoteBtn;
        if (elements.finishBtnFile) elements.finishBtnFile.textContent = t.finishBtn;
        if (elements.noNotesPlaceholderFile) elements.noNotesPlaceholderFile.textContent = t.noNotesPlaceholder;
        if (elements.footerInfoFile) elements.footerInfoFile.textContent = t.footerInfo;

        if (elements.notesTitleYt) {
            const countSpan = elements.notesTitleYt.querySelector('span');
            const count = countSpan ? countSpan.textContent : '0';
            elements.notesTitleYt.innerHTML = `${t.notesTitle} (<span id="noteCountYt">${count}</span>)`;
        }
        if (elements.clearNotesBtnYt) elements.clearNotesBtnYt.textContent = t.clearNotesBtn;
        if (elements.durationLabelYt) elements.durationLabelYt.textContent = t.durationLabel;
        if (elements.durationSecYt) elements.durationSecYt.textContent = t.durationSec;
        if (elements.addNoteBtnYt) elements.addNoteBtnYt.textContent = t.addNoteBtn;
        if (elements.finishBtnYt) elements.finishBtnYt.textContent = t.finishBtn;
        if (elements.noNotesPlaceholderYt) elements.noNotesPlaceholderYt.textContent = t.noNotesPlaceholder;
        if (elements.footerInfoYt) elements.footerInfoYt.textContent = t.footerInfoYt;

        if (elements.langLabel) elements.langLabel.textContent = 'ğŸŒ ' + (lang === 'tr' ? 'Dil' : lang === 'en' ? 'Language' : lang === 'ru' ? 'Ğ¯Ğ·Ñ‹Ğº' : lang === 'ar' ? 'Ø§Ù„Ù„ØºØ©' : 'Langue') + ':';
        
        updateCameraDropdown(); // Kamera dropdown'unu gÃ¼ncelle
    }

    // Dil deÄŸiÅŸtir
    const langSelect = document.getElementById('langSelect');

    // TarayÄ±cÄ± dilini algÄ±la ve varsayÄ±lanÄ± ayarla
    function getBrowserLanguage() {
        const browserLang = navigator.language || navigator.userLanguage || 'en';
        const langCode = browserLang.split('-')[0]; // 'tr', 'en', 'fr' gibi
        const supported = ['tr', 'en', 'ru', 'ar', 'fr'];
        if (supported.includes(langCode)) {
            return langCode;
        }
        return 'en';
    }

    currentLang = getBrowserLanguage();
    langSelect.value = currentLang;

    langSelect.addEventListener('change', (e) => {
        currentLang = e.target.value;
        translatePage(currentLang);
        if (recognition) {
            switch (currentLang) {
                case 'tr': recognition.lang = 'tr-TR'; break;
                case 'en': recognition.lang = 'en-US'; break;
                case 'ru': recognition.lang = 'ru-RU'; break;
                case 'ar': recognition.lang = 'ar-SA'; break;
                case 'fr': recognition.lang = 'fr-FR'; break;
                default: recognition.lang = 'tr-TR';
            }
        }
    });

    // ----- ORTAK DEÄÄ°ÅKENLER -----
    let notes = [];
    let currentSource = 'camera';
    let isRecording = false;

    // CanlÄ± kayÄ±t
    let mediaStream = null;
    let mediaRecorder = null;
    let recordedChunks = [];
    let recordedBlob = null;
    let recordedVideoURL = null;

    // Kamera seÃ§ici iÃ§in deÄŸiÅŸkenler
    let availableCameras = [];
    let currentCameraId = null;

    // Dosya yÃ¼kleme
    let uploadedFileBlob = null;
    let uploadedFileName = 'video.mp4';

    // YouTube
    let youtubePlayer = null;

    // Not ekleme modalÄ±
    const modal = document.getElementById('noteModal');
    const noteTextInput = document.getElementById('noteTextInput');
    const modalSaveBtn = document.getElementById('modalSaveBtn');
    const modalCancelBtn = document.getElementById('modalCancelBtn');
    const speechBtn = document.getElementById('speechBtn');
    let pendingNoteSource = null;
    let pendingNoteTime = null;

    // Ses tanÄ±ma
    let recognition = null;
    let isListening = false;

    if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        recognition = new SpeechRecognition();
        recognition.lang = currentLang === 'tr' ? 'tr-TR' : (currentLang === 'en' ? 'en-US' : currentLang === 'ru' ? 'ru-RU' : currentLang === 'ar' ? 'ar-SA' : 'fr-FR');
        recognition.interimResults = true;
        recognition.continuous = true;

        recognition.onresult = (event) => {
            let transcript = '';
            for (let i = 0; i < event.results.length; i++) {
                transcript += event.results[i][0].transcript;
            }
            noteTextInput.value = transcript;
        };

        recognition.onerror = (event) => {
            console.error('Ses tanÄ±ma hatasÄ±:', event.error);
            alert(translations[currentLang].alertError + ' ' + event.error);
            stopListening();
        };

        recognition.onend = () => {
            stopListening();
        };
    } else {
        console.warn('Bu tarayÄ±cÄ± ses tanÄ±mayÄ± desteklemiyor.');
        speechBtn.disabled = true;
        speechBtn.title = 'TarayÄ±cÄ±nÄ±z ses tanÄ±mayÄ± desteklemiyor.';
    }

    function startListening() {
        if (!recognition) return;
        try {
            recognition.start();
            isListening = true;
            speechBtn.textContent = translations[currentLang].listeningBtn;
            speechBtn.classList.add('listening');
        } catch (e) {}
    }

    function stopListening() {
        if (recognition) {
            try { recognition.stop(); } catch (e) {}
        }
        isListening = false;
        speechBtn.textContent = translations[currentLang].speechBtn;
        speechBtn.classList.remove('listening');
    }

    function openModal(source, time) {
        pendingNoteSource = source;
        pendingNoteTime = time;
        noteTextInput.value = '';
        modal.classList.add('active');
        noteTextInput.focus();
        translatePage(currentLang);
    }

    function closeModal() {
        modal.classList.remove('active');
        pendingNoteSource = null;
        pendingNoteTime = null;
        if (isListening) stopListening();
    }

    modalSaveBtn.addEventListener('click', () => {
        const text = noteTextInput.value.trim();
        if (!text) { alert(translations[currentLang].alertNoteEmpty); return; }
        if (pendingNoteSource && pendingNoteTime !== null) {
            notes.push({ time: pendingNoteTime, text });
            renderAllNotes();
            closeModal();
        } else {
            alert(translations[currentLang].alertError);
            closeModal();
        }
    });

    modalCancelBtn.addEventListener('click', closeModal);
    modal.addEventListener('click', (e) => { if (e.target === modal) closeModal(); });

    speechBtn.addEventListener('click', () => {
        if (!recognition) { alert('Speech recognition not supported'); return; }
        if (isListening) stopListening(); else startListening();
    });

    // ----- DOM ELEMANLARI (sÃ¼re inputlarÄ±) -----
    const noteDurationInput = document.getElementById('noteDuration');
    const noteDurationFile = document.getElementById('noteDurationFile');
    const noteDurationYt = document.getElementById('noteDurationYt');
    const durationInputs = [noteDurationInput, noteDurationFile, noteDurationYt];
    let globalDuration = 3;
    durationInputs.forEach(inp => {
        if (!inp) return;
        inp.addEventListener('input', (e) => {
            globalDuration = parseFloat(e.target.value) || 3;
            durationInputs.forEach(other => { if (other && other !== e.target) other.value = globalDuration; });
        });
    });

    const notesLists = {
        camera: document.getElementById('notesList'),
        file: document.getElementById('notesListFile'),
        youtube: document.getElementById('notesListYt')
    };
    const noteCounts = {
        camera: document.getElementById('noteCount'),
        file: document.getElementById('noteCountFile'),
        youtube: document.getElementById('noteCountYt')
    };

    // Silme butonlarÄ±
    document.getElementById('clearNotesBtn')?.addEventListener('click', clearNotes);
    document.getElementById('clearNotesBtnFile')?.addEventListener('click', clearNotes);
    document.getElementById('clearNotesBtnYt')?.addEventListener('click', clearNotes);

    function clearNotes() {
        if (notes.length && confirm(translations[currentLang].alertConfirmClearNotes)) {
            notes = [];
            renderAllNotes();
        }
    }

    // Not ekleme butonlarÄ±
    document.getElementById('addNoteBtn')?.addEventListener('click', () => prepareAddNote('camera'));
    document.getElementById('addNoteBtnFile')?.addEventListener('click', () => prepareAddNote('file'));
    document.getElementById('addNoteBtnYt')?.addEventListener('click', () => prepareAddNote('youtube'));

    // Bitir butonlarÄ±
    document.getElementById('finishBtn')?.addEventListener('click', () => finish('camera'));
    document.getElementById('finishBtnFile')?.addEventListener('click', () => finish('file'));
    document.getElementById('finishBtnYt')?.addEventListener('click', () => finish('youtube'));

    // Tab geÃ§iÅŸleri
    const tabBtns = document.querySelectorAll('.tab-btn');
    const tabs = {
        camera: document.getElementById('cameraTab'),
        file: document.getElementById('fileTab'),
        youtube: document.getElementById('youtubeTab')
    };

    tabBtns.forEach(btn => {
        btn.addEventListener('click', () => {
            tabBtns.forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            const tab = btn.dataset.tab;
            Object.values(tabs).forEach(t => t.classList.remove('active'));
            tabs[tab].classList.add('active');
            currentSource = tab;
        });
    });

    // ----- YARDIMCI FONKSÄ°YONLAR -----
    function formatShortTime(sec) {
        if (isNaN(sec)) return '0:00';
        const m = Math.floor(sec / 60);
        const s = Math.floor(sec % 60);
        return `${m}:${s.toString().padStart(2, '0')}`;
    }

    function escapeHtml(t) {
        return t.replace(/[&<>"]/g, function(m) {
            if (m === '&') return '&amp;';
            if (m === '<') return '&lt;';
            if (m === '>') return '&gt;';
            return '&quot;';
        });
    }

    function renderAllNotes() {
        const sorted = [...notes].sort((a, b) => a.time - b.time);
        for (let key in notesLists) {
            const ul = notesLists[key];
            if (!ul) continue;
            ul.innerHTML = '';
            if (sorted.length === 0) {
                ul.innerHTML = `<li style="color:#94a3b8; text-align:center;">${translations[currentLang].noNotesPlaceholder}</li>`;
            } else {
                sorted.forEach((n, i) => {
                    const li = document.createElement('li');
                    li.className = 'note-item';
                    li.innerHTML = `<span class="note-time">${formatShortTime(n.time)}</span>
                        <span class="note-text">${escapeHtml(n.text)}</span>
                        <button class="delete-note" data-index="${i}">âœ–</button>`;
                    ul.appendChild(li);
                });
            }
        }
        document.querySelectorAll('.delete-note').forEach(btn => {
            btn.addEventListener('click', (e) => {
                const idx = btn.dataset.index;
                if (idx !== undefined) {
                    notes.splice(idx, 1);
                    renderAllNotes();
                }
            });
        });
        for (let key in noteCounts) {
            if (noteCounts[key]) noteCounts[key].innerText = notes.length;
        }
    }

    function prepareAddNote(source) {
        let time;
        if (source === 'camera') {
            const vid = document.getElementById('recordedVideo');
            if (!vid || !vid.src) { alert(translations[currentLang].alertRecVideoNotFound); return; }
            time = vid.currentTime;
        } else if (source === 'file') {
            const vid = document.getElementById('recordedVideoFile');
            if (!vid || !vid.src) { alert(translations[currentLang].alertFileNotFound); return; }
            time = vid.currentTime;
        } else if (source === 'youtube') {
            if (!youtubePlayer) { alert(translations[currentLang].alertYoutubeNotFound); return; }
            time = youtubePlayer.getCurrentTime();
        }
        if (time === undefined || isNaN(time) || time < 0) { alert(translations[currentLang].alertTimeError); return; }
        openModal(source, time);
    }

    // ----- KAMERA SEÃ‡Ä°CÄ° FONKSÄ°YONLARI -----
    const liveVideo = document.getElementById('liveCamera');
    const cameraSelectorBtn = document.getElementById('cameraSelectorBtn');
    const cameraDropdown = document.getElementById('cameraDropdown');
    const toggleBtn = document.getElementById('recordToggleBtn');
    const recordedVideo = document.getElementById('recordedVideo');
    const clearRecordedBtn = document.getElementById('clearRecordedBtn');

    // Kamera listesini al
    async function getAvailableCameras() {
        try {
            cameraDropdown.innerHTML = `<div class="no-cameras-message">${translations[currentLang].loadingCameras}</div>`;
            
            // GeÃ§ici bir stream alarak izin istemi yap
            const tempStream = await navigator.mediaDevices.getUserMedia({ video: true });
            tempStream.getTracks().forEach(track => track.stop());
            
            const devices = await navigator.mediaDevices.enumerateDevices();
            availableCameras = devices.filter(device => device.kind === 'videoinput');
            updateCameraDropdown();
            
        } catch (err) {
            cameraDropdown.innerHTML = `<div class="no-cameras-message">${translations[currentLang].alertNoCamera}</div>`;
        }
    }

    // Dropdown'u gÃ¼ncelle
    function updateCameraDropdown() {
        if (availableCameras.length === 0) {
            cameraDropdown.innerHTML = `<div class="no-cameras-message">${translations[currentLang].noCamerasFound}</div>`;
            return;
        }
        
        let html = '';
        availableCameras.forEach((camera, index) => {
            let cameraName = camera.label || `Kamera ${index + 1}`;
            let badge = '';
            const t = translations[currentLang];
            
            if (cameraName.toLowerCase().includes('front') || cameraName.toLowerCase().includes('Ã¶n')) {
                badge = `<span class="camera-badge">${t.frontCamera}</span>`;
            } else if (cameraName.toLowerCase().includes('back') || cameraName.toLowerCase().includes('arka')) {
                badge = `<span class="camera-badge">${t.backCamera}</span>`;
            } else if (cameraName.includes('USB') || cameraName.includes('HD') || cameraName.includes('external')) {
                badge = `<span class="camera-badge">${t.externalCamera}</span>`;
            }
            
            const isSelected = (currentCameraId === camera.deviceId) || (!currentCameraId && index === 0);
            
            html += `
                <div class="camera-option ${isSelected ? 'selected' : ''}" data-device-id="${camera.deviceId}">
                    <svg viewBox="0 0 24 24">
                        <path d="M20 5h-3.17L15 3H9L7.17 5H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 14H4V7h4.05l1.83-2h4.24L16.05 7H20v12zM12 9c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zm0 8c-1.65 0-3-1.35-3-3s1.35-3 3-3 3 1.35 3 3-1.35 3-3 3z"/>
                    </svg>
                    <span class="camera-name">${cameraName}</span>
                    ${badge}
                </div>
            `;
        });
        
        cameraDropdown.innerHTML = html;
        
        document.querySelectorAll('.camera-option').forEach(option => {
            option.addEventListener('click', async () => {
                if (isRecording) {
                    alert(translations[currentLang].cameraSelectDisabled);
                    return;
                }
                const deviceId = option.dataset.deviceId;
                await switchToCamera(deviceId);
                cameraDropdown.classList.remove('show');
            });
        });
    }

    // Kameraya geÃ§iÅŸ
    async function switchToCamera(deviceId) {
        try {
            if (mediaStream) {
                mediaStream.getTracks().forEach(track => track.stop());
            }

            const constraints = {
                video: { deviceId: { exact: deviceId } },
                audio: true
            };
            
            mediaStream = await navigator.mediaDevices.getUserMedia(constraints);
            liveVideo.srcObject = mediaStream;
            currentCameraId = deviceId;
            
            // KayÄ±t varsa durdur
            if (mediaRecorder && mediaRecorder.state !== 'inactive') {
                mediaRecorder.stop();
            }
            mediaRecorder = null;
            
            updateCameraDropdown();
            
        } catch (err) {
            alert(translations[currentLang].alertNoCamera + err.message);
        }
    }

    // Ä°lk kamerayÄ± baÅŸlat
    async function initFirstCamera() {
        await getAvailableCameras();
        if (availableCameras.length > 0) {
            await switchToCamera(availableCameras[0].deviceId);
        }
    }

    // Dropdown aÃ§/kapat
    cameraSelectorBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        if (isRecording) {
            alert(translations[currentLang].cameraSelectDisabled);
            return;
        }
        cameraDropdown.classList.toggle('show');
    });

    // DÄ±ÅŸarÄ± tÄ±klandÄ±ÄŸÄ±nda kapat
    document.addEventListener('click', (e) => {
        if (!cameraSelectorBtn.contains(e.target) && !cameraDropdown.contains(e.target)) {
            cameraDropdown.classList.remove('show');
        }
    });

    // Kamera baÅŸlat
    initFirstCamera();

    // ----- KAMERA KAYIT -----
    toggleBtn.addEventListener('click', () => {
        if (!mediaStream) { alert(translations[currentLang].alertNoStream); return; }

        if (!mediaRecorder || mediaRecorder.state === 'inactive') {
            recordedChunks = [];
            try {
                mediaRecorder = new MediaRecorder(mediaStream, { mimeType: 'video/webm' });
                mediaRecorder.ondataavailable = (e) => { if (e.data.size) recordedChunks.push(e.data); };
                mediaRecorder.onstop = () => {
                    recordedBlob = new Blob(recordedChunks, { type: 'video/webm' });
                    if (recordedVideoURL) URL.revokeObjectURL(recordedVideoURL);
                    recordedVideoURL = URL.createObjectURL(recordedBlob);
                    recordedVideo.src = recordedVideoURL;
                    
                    isRecording = false;
                    translatePage(currentLang);
                    cameraSelectorBtn.classList.remove('disabled');
                };
                mediaRecorder.start();
                
                isRecording = true;
                translatePage(currentLang);
                cameraSelectorBtn.classList.add('disabled');
                
                if (notes.length && !confirm(translations[currentLang].alertNewRecordClear)) {}
                else { notes = []; renderAllNotes(); }
            } catch (e) { alert(translations[currentLang].alertError + e); }
        } else {
            if (mediaRecorder.state !== 'inactive') {
                mediaRecorder.stop();
            }
        }
    });

    clearRecordedBtn.addEventListener('click', () => {
        if (recordedVideoURL) {
            URL.revokeObjectURL(recordedVideoURL);
            recordedVideoURL = null;
        }
        recordedVideo.src = '';
        recordedBlob = null;
    });

    // ----- DOSYA YÃœKLE -----
    const fileInput = document.getElementById('fileUpload');
    const loadFileBtn = document.getElementById('loadFileBtn');
    loadFileBtn.addEventListener('click', () => {
        const file = fileInput.files[0];
        if (!file) { alert(translations[currentLang].alertSelectFile); return; }
        uploadedFileName = file.name;
        const reader = new FileReader();
        reader.onload = (e) => {
            uploadedFileBlob = new Blob([e.target.result], { type: file.type });
            const url = URL.createObjectURL(uploadedFileBlob);
            document.getElementById('recordedVideoFile').src = url;
        };
        reader.readAsArrayBuffer(file);
    });

    // ----- YOUTUBE -----
    const youtubeInput = document.getElementById('youtubeInput');
    const loadYoutubeBtn = document.getElementById('loadYoutubeBtn');

    function extractVideoId(input) {
        input = input.trim();
        const patterns = [
            /(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/)([^&?#]+)/,
            /^([a-zA-Z0-9_-]{11})$/
        ];
        for (let pattern of patterns) {
            const match = input.match(pattern);
            if (match && match[1]) return match[1];
        }
        if (/^[a-zA-Z0-9_-]{11}$/.test(input)) return input;
        return null;
    }

    loadYoutubeBtn.addEventListener('click', () => {
        const raw = youtubeInput.value;
        const videoId = extractVideoId(raw);
        if (!videoId) {
            alert(translations[currentLang].alertValidYoutubeId);
            return;
        }

        const container = document.getElementById('youtubeContainerYt');
        container.innerHTML = '';

        try {
            youtubePlayer = new YT.Player('youtubeContainerYt', {
                videoId: videoId,
                events: {
                    onReady: (e) => console.log('YouTube hazÄ±r'),
                    onError: (e) => {
                        let msg = translations[currentLang].alertError + ' YouTube: ';
                        switch (e.data) {
                            case 2: msg += 'GeÃ§ersiz video ID'; break;
                            case 5: msg += 'HTML5 player hatasÄ±'; break;
                            case 100: msg += 'Video bulunamadÄ± veya silinmiÅŸ'; break;
                            case 101: msg += 'Video embed edilemez'; break;
                            default: msg += 'Bilinmeyen hata';
                        }
                        alert(msg);
                    }
                }
            });
        } catch (err) {
            alert(translations[currentLang].alertError + err.message);
        }
    });

    // ----- VTT OLUÅTURMA VE ZÄ°P -----
    function formatVTTTime(seconds) {
        const h = Math.floor(seconds / 3600);
        const m = Math.floor((seconds % 3600) / 60);
        const s = Math.floor(seconds % 60);
        const ms = Math.floor((seconds - Math.floor(seconds)) * 1000);
        return `${h.toString().padStart(2, '0')}:${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}.${ms.toString().padStart(3, '0')}`;
    }

    async function finish(source) {
        const defaultDuration = globalDuration || 3;
        const sorted = [...notes].sort((a, b) => a.time - b.time);
        let vtt = 'WEBVTT\n\n';
        for (let i = 0; i < sorted.length; i++) {
            const note = sorted[i];
            const start = note.time;
            let end;
            if (i < sorted.length - 1) {
                end = Math.min(start + defaultDuration, sorted[i + 1].time);
            } else end = start + defaultDuration;
            if (end <= start) end = start + 0.2;
            vtt += `${i + 1}\n${formatVTTTime(start)} --> ${formatVTTTime(end)}\n${note.text}\n\n`;
        }

        const zip = new JSZip();
        zip.file('altyazi.vtt', vtt);

        if (source === 'camera' && recordedBlob) {
            zip.file('kayit.webm', recordedBlob);
        } else if (source === 'file' && uploadedFileBlob) {
            zip.file(uploadedFileName, uploadedFileBlob);
        } else if (source === 'youtube') {
            alert(translations[currentLang].alertYoutubeNoVideo);
        } else {
            alert(translations[currentLang].alertNoVideoBlob);
        }

        const zipBlob = await zip.generateAsync({ type: 'blob' });
        const url = URL.createObjectURL(zipBlob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `notlar_${new Date().toISOString().slice(0, 19).replace(/:/g, '-')}.zip`;
        a.click();
        URL.revokeObjectURL(url);
    }

    // Temizlik
    window.addEventListener('beforeunload', () => {
        if (mediaStream) mediaStream.getTracks().forEach(t => t.stop());
        if (recordedVideoURL) URL.revokeObjectURL(recordedVideoURL);
    });

    // Ä°lk Ã§eviriyi yap (seÃ§ilen dil ile)
    translatePage(currentLang);
})();
</script>
</body>
</html>